# Навигация v1 — план внедрения

Документ фиксирует структуру навигации в репозитории и этапы включения функциональности.

## Структура каталогов (App Router)

- `app/(main)` — текущий работающий интерфейс.
- `app/(marketing)` — маркетинговый раздел (главная, продукт, аудитории, проекты, специалисты, подрядчики, тарифы, блог, вход/регистрация). При `NAV_V1=off` страницы редиректят на `/home`.
- `app/mkt` — дубль маркетинговых маршрутов без проверки флага (`/mkt`, `/mkt/product`, `/mkt/audience`, …) для QA.
- `app/(app)` — оболочка для авторизованной части приложения (заглушка, оборачивает детей и содержит sr-only сообщение про NAV_V1).
- `app/(project)/[id]` — обёртка для страниц конкретного проекта (sr-only сообщение, контент появится на следующих этапах).

## Этапы 0–7

1. **Этап 0.** Настройка окружения, фиче-флаг `NAV_V1`, заглушки и документация.
2. **Этап 1.** Подключение новой навигации v1 и маркетингового раздела.
3. **Этап 2.** Реализация основной оболочки приложения и состояния UI.
4. **Этап 3.** Детализация ролей и прав доступа.
5. **Этап 4.** Интеграция проектных layout'ов и маршрутов.
6. **Этап 5.** Улучшения UX/UI, локализация и контент.
7. **Этап 6.** Нагрузочное тестирование и оптимизации.
8. **Этап 7.** Финальные правки, устранение предупреждений, подготовка к релизу.

## Проверка DoD

- Фиче-флаги читаются из `apps/web/lib/feature-flags.ts`.
- Для включения NAV_V1 установить `NAV_V1=on` и перезапустить приложение. Маркетинговые маршруты доступны по корневым путям и по префиксу `/mkt`.
- Страницы содержат hero/CTA-блоки и метаданные для SEO (`metadata`, `sitemap`, `robots`).
- Верхнее меню и мобильный бургер берут конфигурацию из `apps/web/config/MarketingMenu.config.ts`.
- Локаль приложения задаётся `APP_LOCALE` и прокидывается в `<html lang>`.
- Zustand store `apps/web/lib/state/ui-store.ts` предоставляет минимальный каркас для управления проектом и состоянием меню.
- Тесты: `pnpm test` (Jest) и `pnpm test:e2e` (Playwright). Playwright запускается с `NAV_V1=on` и проверяет десктопное/мобильное меню.
